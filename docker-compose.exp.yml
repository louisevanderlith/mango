version: "3.4"

services:
  secure:
    image: avosa/secure:dev
    build: ./secure/
    ports:
      - "8086:8086"
    volumes:
      - ./secure/db/:/db

  theme:
    image: avosa/theme:dev
    command: --security=http://secure:8086
    build: ./theme/
    ports:
      - "8093:8093"
    depends_on:
      - secure
    volumes:
      - ./theme/db/:/db

  entity:
    image: avosa/entity:dev
    command: --security=http://secure:8086
    build: ./entity/
    ports:
      - "8097:8097"
    depends_on:
      - secure
    volumes:
      - ./entity/db/:/db

  cms:
    image: avosa/cms:dev
    command: --security=http://secure:8086
    build: ./cms/
    ports:
      - "8090:8090"
    depends_on:
      - secure
    volumes:
      - ./cms/db/:/db

  blog:
    image: avosa/blog:dev
    command: --security=http://secure:8086
    build: ./blog/
    ports:
      - "8102:8102"
    depends_on:
      - secure
    volumes:
      - ./blog/db/:/db

  comment:
    image: avosa/comment:dev
    command: --security=http://secure:8086
    build: ./comment/
    ports:
      - "8084:8084"
    depends_on:
      - secure
    volumes:
      - ./comment/db/:/db

  comms:
    image: avosa/comms:dev
    command: --security=http://secure:8086
    build: ./comms/
    ports:
      - "8085:8085"
    depends_on:
      - secure
    volumes:
      - ./comms/db/:/db

  artifact:
    image: avosa/artifact:dev
    command: --security=http://secure:8086
    build: ./artifact/
    ports:
      - "8082:8082"
    depends_on:
      - secure
    volumes:
      - ./artifact/db/:/db

  stock:
    image: avosa/stock:dev
    command: --security=http://secure:8086
    build: ./stock/
    ports:
      - "8101:8101"
    depends_on:
      - secure
    volumes:
      - ./stock/db/:/db

  vin:
    image: avosa/vin:dev
    command: --security=http://secure:8086
    build: ./vin/
    ports:
      - "8095:8095"
    depends_on:
      - secure
    volumes:
      - ./vin/db/:/db

  admin:
    image: avosa/admin:dev
    command:
      - --security=http://secure:8086
      - --client=tango.admin
    build: ./admin/
    depends_on:
      - theme
    ports:
      - "8088:8088"

  wheelo:
    image: avosa/wheelo:dev
    command:
      - --security=http://secure:8086
      - --client=tango.wheelo
    build: ./wheelo/
    depends_on:
      - theme
    ports:
      - "8105:8105"

  www:
    image: avosa/www:dev
    build: ./www/
    ports:
      - "8091:8091"
    depends_on:
      - theme
    command:
      - --client=tango.www
      - --security=http://secure:8086

  auth:
    image: avosa/auth:dev
    build: ./auth/
    command: --security=http://secure:8086
    ports:
      - "8094:8094"
    depends_on:
      - theme