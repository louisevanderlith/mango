package util

import (
	"github.com/astaxie/beego"
	"github.com/louisevanderlith/mango/util/enums"
)

type SecureController struct {
	beego.Controller
}

var authFunctions map[string]enums.RoleType

func init() {
	authFunctions = make(map[string]enums.RoleType)
}

func (ctrl *SecureController) Prepare() {
	if !userAllowed(ctrl) {
		ctrl.CustomAbort(401, unAuthHTML)
	}
}

func (ctrl *SecureController) GetAvoToken() string {
	return ctrl.Ctx.GetCookie("avotoken");
}

func (ctrl *SecureController) ExpireAvoToken() {
	ctrl.Ctx.SetCookie("avotoken", "expired", 0)
}

func (ctrl *SecureController) SetAvoToken(token string) {
	ctrl.Ctx.SetCookie("avotoken", token, 600, "/", "avosa.co.za", true, true)
}

func ProtectMethods(auths map[string]enums.RoleType) {
	authFunctions = auths
}

func userAllowed(ctrl *SecureController) bool {
	result := true
	method := ctrl.Ctx.Request.Method
	authFunc, hasKey := authFunctions[method]

	if hasKey {
		userSession := ctrl.GetAvoToken()

		result = hasRole(userSession, authFunc)
	}

	return result
}

// Not-Authorized Page
const unAuthHTML = "<!DOCTYPE html><html lang=\"en\"><head><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\"><meta name=\"author\" content=\"avosa Software\"><link rel=\"icon\" href=\"https://avosa.co.za/favicon.png\" type=\"image/x-icon\"><title>avosa Not-Authorized</title><style>body{display:block;margin:auto;margin-left:auto;margin-right:auto}</style></head><body> <img src=\"data:image/png;base64,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\" /><h1>User not authorized to view this content.</h1> <span>Please Login before attempting to view this content.</span> <a href=\"https://avosa.co.za\">Login</a></body></html>"
